@using Microsoft.AspNet.Identity
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Website</title>
    <!-- for icons  -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">
    <!-- bootstrap  -->
    <link rel="stylesheet" href="~/Content/Layout/assets/css/bootstrap.min.css">
    <!-- for swiper slider  -->
    <link rel="stylesheet" href="~/Content/Layout/assets/css/swiper-bundle.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <!-- fancy box  -->
    <link rel="stylesheet" href="~/Content/Layout/assets/css/jquery.fancybox.min.css">
    <!-- custom css  -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="~/Content/style.css" rel="stylesheet" />

    <style>
        .main-navigation .menu li a {
            padding: 5px 10px;
        }

        ul.menu.food-nav-menu {
            margin-bottom: 0;
        }

        .site-header {
            background: #fff;
            box-shadow: rgb(50 50 93 / 10%) 0px 6px 12px -2px, rgb(0 0 0 / 0%) 0px 3px 7px;
        }
    </style>
</head>


<body class="body-fixed">
    <!-- start of header  -->
    <header class="site-header">
        <div class="container" style="max-width: 1400px;">
            <div class="row">
                <div class="col-lg-2">
                    <div class="header-logo">
                        <a href="index.html">
                            @*<img href="~/Product/Index" src="/Content/Layout/logo.png" width="160" height="36" alt="Logo">*@
                            <a href="~/Product/Index"> <img href="~/Product/Index" src="/Content/Layout/logo.png" width="160" height="36" alt="Logo"></a>
                        </a>
                    </div>
                </div>
                <div class="col-lg-10">
                    <div class="main-navigation" style="justify-content: flex-start;">
                        <button class="menu-toggle"><span></span><span></span></button>
                        <nav class="header-menu">
                            <ul class="menu food-nav-menu">
                                <li>@Html.ActionLink(Resources.MENU_HOME, "Index", "Product")</li>
                                @*<li><a href="#about">@Resources.MENU_ABOUT</a></li>*@
                                <li><a href="#menu">@Resources.MENU_MENU</a></li>
                                <li>@Html.ActionLink("Lịch sử mua hàng ", "Index", "Order_detail")</li>
                                @*<li><a href="#gallery">@Resources.MENU_GALLEY</a></li>
                                <li><a href="#blog">@Resources.MENU_BLOG</a></li>*@
                                <li><a href="#contact">@Resources.MENU_CONTACT</a></li>
                            </ul>
                        </nav>
                        <div class="header-right">
                            @*@using (Html.BeginForm("Search", "Product", FormMethod.Get))
                                {*@
                            <form class="header-search-form for-des">
                                <input id="Search" class="form-input" placeholder="Search Here...">
                                @*<button  type="submit">
                                        <i class="uil uil-search"></i>
                                    </button>*@
                                @*}*@
                            </form>
                            <a href="~/ShoppingCart/Index" class="header-btn header-cart">
                                <i class="uil uil-shopping-bag"></i>
                                @*<span class="cart-number">3</span>*@
                                <span id="Cart-status" class="cart-number">@ViewBag.CartCount</span>
                            </a>
                            @if (Request.IsAuthenticated)
                            {
                                using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
                                {
                                    @Html.AntiForgeryToken()

                                    <ul class="nav navbar-nav navbar-right nav-user">
                                        <li>
                                            @Html.ActionLink(User.Identity.GetUserName(), "Index", "Manage", routeValues: null, htmlAttributes: new { title = "Manage" })
                                        </li>
                                        <li><a href="javascript:document.getElementById('logoutForm').submit()">Log off</a></li>
                                    </ul>
                                    <a href="~/Account/Login" class="header-btn">
                                        <i class="uil uil-user-md">
                                        </i>
                                    </a>
                                }
                            }
                            else
                            {
                                <a href="~/Account/Login" class="header-btn">
                                    <i class="uil uil-user-md">
                                    </i>
                                </a>
                            }



                            @*<div>
                                    @Html.Partial("_LoginPartial")
                                </div>*@
                            <a href="~/Heart/Index" class="header-btn">
                                <i class="fa-regular fa-heart" style="color: #FFA500"></i>
                                <span id="Heart-status" class="cart-number">@ViewBag.WishlistCount</span>
                            </a>

                            <a href="#">
                                @Html.Partial("_Flag")
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <style>
            form#logoutForm:hover .nav-user {
                visibility: visible;
                transition: 0.4s;
            }

            .nav-user {
                visibility: hidden;
                position: absolute;
                background: #fff;
                bottom: -75px;
                transition: 0.4s;
            }
        </style>
    </header>
    <!-- header ends  -->

    <div id="viewport">
        <div id="js-scroll-content" style="margin-top: 200px">
            @RenderBody()


            <!-- footer starts  -->
            <footer class="site-footer" id="contact">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d125409.77948296019!2d106.53850631640626!3d10.807053000000002!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3174d93fb381e671%3A0x85509c9a1ac479c1!2sKATA%20SHOP!5e0!3m2!1svi!2s!4v1678948125059!5m2!1svi!2s" frameborder="0" style="border:0; width: 100%;" allowfullscreen=""></iframe>
                <div class="top-footer section">
                    <div class="sec-wp">
                        <div class="container">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="footer-info">
                                        <div class="footer-logo">
                                            <a href="index.html">
                                                <img src="logo.png" alt="">
                                            </a>
                                        </div>
                                        <p>
                                            Lorem ipsum, dolor sit amet consectetur adipisicing elit. Mollitia, tenetur.
                                        </p>
                                        <div class="social-icon">
                                            <ul>
                                                <li>
                                                    <a href="#">
                                                        <i class="uil uil-facebook-f"></i>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <i class="uil uil-instagram"></i>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <i class="uil uil-github-alt"></i>
                                                    </a>
                                                </li>
                                                <li>
                                                    <a href="#">
                                                        <i class="uil uil-youtube"></i>
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-8">
                                    <div class="footer-flex-box">
                                        <div class="footer-table-info">
                                            <h3 class="h3-title">open hours</h3>
                                            <ul>
                                                <li><i class="uil uil-clock"></i> Mon-Thurs : 9am - 22pm</li>
                                                <li><i class="uil uil-clock"></i> Fri-Sun : 11am - 22pm</li>
                                            </ul>
                                        </div>
                                        <div class="footer-menu food-nav-menu">
                                            <h3 class="h3-title">Links</h3>
                                            <ul class="column-2">
                                                <li>
                                                    <a href="#home" class="footer-active-menu">Home</a>
                                                </li>
                                                <li><a href="#about">About</a></li>
                                                <li><a href="#menu">Menu</a></li>
                                                <li><a href="#gallery">Gallery</a></li>
                                                <li><a href="#blog">Blog</a></li>
                                                <li><a href="#contact">Contact</a></li>
                                            </ul>
                                        </div>
                                        <div class="footer-menu">
                                            <h3 class="h3-title">Company</h3>
                                            <ul>
                                                <li><a href="#">Terms & Conditions</a></li>
                                                <li><a href="#">Privacy Policy</a></li>
                                                <li><a href="#">Cookie Policy</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bottom-footer">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-12 text-center">
                                <div class="copyright-text">
                                    <p>
                                        Copyright &copy; 2021 <span class="name">TechieCoder.</span>All Rights Reserved.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <button class="scrolltop"><i class="uil uil-angle-up"></i></button>
                    </div>
                </div>
            </footer>



        </div>
    </div>





    <!-- jquery  -->
    <script src="~/Content/Layout/assets/js/jquery-3.5.1.min.js"></script>
    <!-- bootstrap -->
    <script src="~/Content/Layout/assets/js/bootstrap.min.js"></script>
    <script src="~/Content/Layout/assets/js/popper.min.js"></script>

    <!-- fontawesome  -->
    <script src="~/Content/Layout/assets/js/font-awesome.min.js"></script>

    <!-- swiper slider  -->
    <script src="~/Content/Layout/assets/js/swiper-bundle.min.js"></script>

    <!-- mixitup -- filter  -->
    <script src="~/Content/Layout/assets/js/jquery.mixitup.min.js"></script>

    <!-- fancy box  -->
    <script src="~/Content/Layout/assets/js/jquery.fancybox.min.js"></script>

    <!-- parallax  -->
    <script src="~/Content/Layout/assets/js/parallax.min.js"></script>

    <!-- gsap  -->
    <script src="~/Content/Layout/assets/js/gsap.min.js"></script>

    <!-- scroll trigger  -->
    <script src="~/Content/Layout/assets/js/ScrollTrigger.min.js"></script>
    <!-- scroll to plugin  -->
    <script src="~/Content/Layout/assets/js/ScrollToPlugin.min.js"></script>
    <!-- rellax  -->
     <script src="assets/js/rellax.min.js"></script> 
     <script src="assets/js/rellax-custom.js"></script> 
    <!-- smooth scroll  -->
    <script src="~/Content/Layout/assets/main.js"></script>
    <script src="~/Content/Layout/assets/js/smooth-scroll.js"></script>
    <!-- custom js  -->


</body>

</html>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/lib/easing/easing.min.js"></script>
<script src="~/lib/waypoints/waypoints.min.js"></script>
<script src="~/lib/owlcarousel/owl.carousel.min.js"></script>
<script src="~/lib/tempusdominus/js/moment.min.js"></script>
<script src="~/lib/tempusdominus/js/moment-timezone.min.js"></script>
<script src="~/lib/tempusdominus/js/tempusdominus-bootstrap-4.min.js"></script>
<!-- Template Javascript -->
<script src="~/js/main.js"></script>

@*<script src="~/Content/NN/assets/js/jquery.min.js"></script>*@

<script>

    $(document).ready(function () {
        $("#Search").on("keyup", function () {
            /*  alert("ttttt");*/
            var value = $(this).val().toLowerCase();

            console.log(value);
            $.ajax({
                url: '/Product/Search',
                type: "GET",
                data: { searchString: value },

                success: function (data) {
                    console.log(data);
                    $('#menu-dish').html(data);
                },
                error: function (xhr) {
                    console.log('error');
                }
            });
        });
    });

</script>
<script>
    function updateCartSummary() {
        $.ajax({
            url: '/ShoppingCart/CartSummary',
            type: 'GET',
            success: function (data) {
                $('#Cart-status').html(data);
            }
        });
    }
    // Gọi function updateCartSummary khi trang web được load
    $(document).ready(function () {
        updateCartSummary();
    });
</script>
<script>
    function updateWishlistCount() {
        $.ajax({
            url: "/Heart/HeartSummary",
            type: "GET",
            success: function (data) {
                $("#Heart-status").html(data);
            },
            error: function (xhr, status, error) {
                console.log(error);
            }
        });
    }
    $(document).ready(function () {
        updateWishlistCount();
    });



    $(document).ready(function () {
        $('a[href="~/Product/Index"]').click(function (event) {
            event.preventDefault(); // Ngăn chặn trình duyệt chuyển hướng tới trang mới

            $.ajax({
                url: '/Product/Index', // URL của máy chủ của bạn
                type: 'POST', // Loại phương thức HTTP mà bạn muốn sử dụng (GET, POST, PUT, DELETE, ...)
                data: { key1: 'value1', key2: 'value2' }, // Dữ liệu mà bạn muốn gửi đến máy chủ
                dataType: 'json', // Kiểu dữ liệu mà bạn muốn nhận lại từ máy chủ (json, xml, html, text, ...)
                success: function (data) { // Hàm được gọi khi máy chủ trả về dữ liệu thành công
                    // Xử lý dữ liệu ở đây
                    console.log(data);
                },
                error: function (xhr, status, error) { // Hàm được gọi khi có lỗi xảy ra trong quá trình gọi máy chủ
                    console.log('Có lỗi xảy ra: ' + error);
                }
            });
        });
    });
</script>


<!--DOAN CHAT Ne-->
<!-- JavaScript Libraries -->



<button class="nut-mo-chatbox" onclick="moForm()">Chat</button>
<div class="Chatbox" id="myForm">
    <form action="" class="form-container">
        <h1>HỖ TRỢ</h1>
        <label for="msg"><b>Lời Nhắn</b></label>
        <textarea placeholder="Bạn hãy nhập lời nhắn.." name="msg" id="message" required></textarea>
        <ul id="discussion">
        </ul>
        <div style="display:flex">
            <input type="button" class="btn " id="sendmessage" value="Gửi" />
            <input type="hidden" id="displayname" value="@Session["Email"]" />
            <button type="button" class="btn nut-dong-chatbox " onclick="dongForm()">Đóng</button>
        </div>
    </form>
</div>
<style>

    /* Nút Để Mở Chatbox */
    .nut-mo-chatbox {
        z-index: 1;
        background-color: #FF6B6B;
        color: white;
        padding: 16px 20px;
        border: none;
        cursor: pointer;
        opacity: 0.8;
        position: fixed;
        bottom: 23px;
        right: 28px;
        width: 100px;
        border-radius: 20px;
        font-size: 18px;
    }

    /* Ẩn chatbox mặc định */
    .Chatbox {
        display: none;
        position: fixed;
        bottom: 0;
        right: 15px;
        border: 3px solid #f1f1f1;
        z-index: 9;
        width: 300px;
        max-height: 400px;
        overflow-y: scroll;
        border-radius: 10px;
        background-color: #FFFFFF;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    /* Thêm style cho form */
    .form-container {
        max-width: 100%;
        padding: 10px;
        background-color: #F8F8F8;
    }

        /* thiết lập style textarea */
        .form-container textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0 20px 0;
            border: none;
            background: #f1f1f1;
            resize: none;
            min-height: 100px;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
        }

            /*thiết lập style cho textarea khi được focus */
            .form-container textarea:focus {
                background-color: #ddd;
                outline: none;
            }

        /* Sthiết lập style cho nút trong form*/
        .form-container .btn {
            background-color: #4CAF50;
            color: white;
            padding: 12px 16px;
            border: none;
            cursor: pointer;
            width: 100%;
            margin-bottom: 10px;
            opacity: 0.8;
            border-radius: 20px;
            font-size: 18px;
            font-family: 'Roboto', sans-serif;
        }

        /* Thiết lập màu nền cho nút đóng chatbox */
        .form-container .nut-dong-chatbox {
            background-color: red;
        }

        /* Thêm hiệu ứng hover cho nút*/
        .form-container .btn:hover, .nut-mo-chatbox:hover {
            opacity: 1;
        }
</style>
<script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
<!-- SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<!-- SignalR script to update the chat page and send messages.-->
<script>
    /*Hàm Mở Form*/
    function moForm() {
        document.getElementById("myForm").style.display = "block";
    }
    /*Hàm Đóng Form*/
    function dongForm() {
        document.getElementById("myForm").style.display = "none";
    }
</script>
<script>
    $(function () {
        var chat = $.connection.chatHub;
        // Tạo một chức năng mà trung tâm có thể gọi lại để hiển thị thông báo.
        chat.client.addNewMessageToPage = function (name, message) {
            // Thêm tin nhắn vào trang.
            $('#discussion').append('<li><strong>' + htmlEncode(name)
                + '</strong>: ' + htmlEncode(message) + '</li>');
        };
        // Lấy tên người dùng và lưu trữ nó để thêm vào tin nhắn.
        // Đặt tiêu điểm ban đầu cho hộp nhập tin nhắn.
        $('#message').focus();
        // Bắt đầu kết nối.
        $.connection.hub.start().done(function () {
            $('#sendmessage').click(function () {
                // Gọi phương thức Gửi trên trung tâm.
                chat.server.send($('#displayname').val(), $('#message').val());
                // Xóa hộp văn bản và đặt lại tiêu điểm cho nhận xét tiếp theo.
                $('#message').val('').focus();
            });
        });
    });
    // Chức năng tùy chọn này mã hóa html thông báo để hiển thị trong trang.
    function htmlEncode(value) {
        var encodedValue = $('<div />').text(value).html();
        return encodedValue;
    }
</script>
@RenderSection("scripts", required: false)